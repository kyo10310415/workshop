# eラーニング管理システムの作成プロンプト

このプロンプトをAIデベロッパーに貼り付けるだけで、システムが作成されます。

---

## 作ってほしいシステム

**社内向けのeラーニング（研修）管理システム**を作ってください。

### システムの目的
- 管理者が研修資料（PDFやGoogle Docsのリンク）をアップロードできる
- 従業員が資料を見て学習を進められる
- 誰がどこまで学習したか進捗を管理できる

---

## システムの利用者

### 1. 管理者（上司や人事担当者）
- 研修コースを作成・管理できる
- 資料をアップロードできる
- 従業員のアカウントを作成・管理できる

### 2. 一般ユーザー（従業員）
- 自分に公開されている研修コースを見られる
- 資料を閲覧して学習できる
- 自分の学習進捗を確認できる

---

## 必要な機能

### 管理者の機能

#### 1. ログイン機能
- メールアドレスとパスワードでログイン
- 管理者と一般ユーザーを区別する

#### 2. 研修コース管理
- **新しい研修コースを作成**
  - タイトルを入力（例：「新入社員研修」）
  - 説明文を入力（例：「会社の基本的なルールを学びます」）
  - 公開/非公開を選択（非公開の研修は一般ユーザーに表示されない）
- **研修コースを編集・削除**できる

#### 3. 研修資料の管理
- **PDFファイルをアップロード**
  - ファイルを選んでアップロードすると自動的にページ数を取得
  - 資料にタイトルをつけられる（例：「会社規則」）
- **外部リンクを追加**
  - Google DocsやGoogle Sheetsのリンクを登録できる
  - リンクにタイトルをつけられる（例：「勤怠管理マニュアル」）
- **資料を削除**できる

#### 4. ユーザー管理
- **新しいユーザーを作成**
  - メールアドレス、パスワード、名前を入力
  - 管理者か一般ユーザーかを選択
- **ユーザーのパスワードを変更**できる
- **ユーザーを削除**できる

### 一般ユーザーの機能

#### 1. ログイン機能
- メールアドレスとパスワードでログイン

#### 2. 研修コース一覧
- 公開されている研修コースの一覧が見られる
- 各コースの学習進捗が表示される
  - 例：「10ページ中3ページ完了（30%）」
  - 進捗バー（色付きのバー）で視覚的に表示

#### 3. 研修資料の閲覧

##### PDFファイルの場合
- **画面上でPDFを見られる**
  - ページをめくって読める
  - 拡大・縮小ができる
- **進捗が自動的に記録される**
  - どのページまで読んだか自動保存
  - 次回開いたときは続きから読める
- **完了ボタン**
  - 最後まで読んだら「完了」ボタンを押せる
  - 完了すると進捗が100%になる

##### 外部リンク（Google Docs等）の場合
- **リンクを開くボタン**
  - クリックすると新しいタブで開く
- **ダウンロードボタン**
  - Google Docsの場合：PDF、Word、テキスト形式でダウンロード
  - Google Sheetsの場合：PDF、Excel、CSV形式でダウンロード
- **完了ボタン**
  - 内容を確認したら「完了」ボタンを押す

---

## 画面の構成

### 管理者が見る画面

1. **ログイン画面**
   - メールアドレスとパスワード入力欄
   - 「ログイン」ボタン

2. **トップページ（研修一覧）**
   - 全ての研修コース（公開・非公開両方）が表示される
   - 各コースの公開状態が分かる（🌐公開中 / 🔒非公開）
   - 「eラーニング管理」「ユーザー管理」のボタン

3. **研修管理画面**
   - 研修コースの一覧
   - 「新規作成」ボタン
   - 各コースの「編集」「削除」ボタン
   - 公開/非公開の切り替えボタン

4. **資料管理画面**
   - その研修の資料一覧
   - 「研修スライドアップロード」ボタン（PDFファイル用）
   - 「参考資料追加」ボタン（外部リンク用）
   - 各資料の「削除」ボタン

5. **ユーザー管理画面**
   - ユーザーの一覧（ID、メール、名前、役割、作成日）
   - 「ユーザー作成」ボタン
   - 各ユーザーの「パスワード変更」「削除」ボタン

### 一般ユーザーが見る画面

1. **ログイン画面**
   - メールアドレスとパスワード入力欄
   - 「ログイン」ボタン

2. **トップページ（研修一覧）**
   - 公開されている研修コースのみ表示
   - 各コースの学習進捗が表示される
   - 進捗バー（0% → 100%）
   - 完了したコースには「✓完了」マーク

3. **研修詳細画面**
   - 研修のタイトルと説明
   - 全体の学習進捗（例：「15ページ中5ページ完了（33%）」）
   - 資料の一覧
   - 各資料の完了状態

4. **PDFビューア画面**
   - PDFを画面上で表示
   - ページ切り替えボタン（前へ/次へ）
   - 現在のページ数表示（例：「3 / 10ページ」）
   - 「完了にする」「未完了にする」ボタン
   - 「一覧に戻る」ボタン

5. **外部リンク閲覧画面**
   - 資料のタイトルと種類
   - 「外部リンクを開く」ボタン
   - ダウンロードボタン（PDF、Word、Excel等）
   - 「完了にする」「未完了にする」ボタン
   - 「一覧に戻る」ボタン

---

## データの保存内容

### 研修コース
- タイトル（例：「新入社員研修」）
- 説明文
- 公開/非公開の設定
- 作成日

### 研修資料
- タイトル
- 種類（PDF / Google Docs / Google Sheets）
- PDFの場合：ファイル名、ファイルサイズ、ページ数
- 外部リンクの場合：URL
- 作成日

### ユーザー
- メールアドレス
- パスワード（暗号化して保存）
- 名前
- 役割（管理者 / 一般ユーザー）
- 作成日

### 学習進捗
- どのユーザーが
- どの研修コースの
- どの資料を
- どこまで読んだか（PDFの場合は最後に読んだページ）
- 完了したかどうか
- 最終更新日時

---

## 技術的な要件

### 使用する技術
- **フロントエンド（見た目）**：React + TypeScript + TailwindCSS
- **バックエンド（処理）**：Node.js + Express + Prisma
- **データベース**：PostgreSQL
- **デプロイ先**：Render（無料プランで動作すること）

### セキュリティ
- パスワードは必ず暗号化して保存
- ログインしていないユーザーは全てのページにアクセスできない
- 一般ユーザーは管理者用のページにアクセスできない
- 非公開の研修は一般ユーザーに見せない

### PDFの扱い方
- アップロードされたPDFファイルは自動的にページ数を取得
- ファイルはサーバーに保存
- PDFは画面上で表示（ダウンロードせずに見られる）
- ページ単位で進捗を記録

### 外部リンクの扱い方
- Google DocsとGoogle Sheetsに対応
- リンクを新しいタブで開けるようにする
- 各形式でダウンロードできるボタンを用意
  - Google Docs：PDF、Word（DOCX）、テキスト（TXT）
  - Google Sheets：PDF、Excel（XLSX）、CSV

### 進捗の計算方法
- **PDFファイル**：ページ単位で計算
  - 例：研修に10ページのPDFと15ページのPDFがある場合
  - 合計25ページ中、5ページ読んだら20%
- **外部リンク**：完了/未完了のみ
  - 外部リンクは進捗計算に含めない

---

## 初期データ

システムを作ったら、最初から以下のユーザーを登録しておいてください：

### 管理者アカウント
- メールアドレス：`admin@example.com`
- パスワード：`admin123`
- 名前：`管理者`
- 役割：管理者

### テストユーザーアカウント
- メールアドレス：`user@example.com`
- パスワード：`user123`
- 名前：`テストユーザー`
- 役割：一般ユーザー

---

## Renderへのデプロイ設定

### 必要な設定

#### データベース
- Renderで無料のPostgreSQLデータベースを作成
- 自動的に接続されるようにする

#### 環境変数
以下の環境変数を自動的に設定：
- `DATABASE_URL`：データベース接続情報
- `JWT_SECRET`：ランダムな文字列（ログイン認証用）
- `NODE_ENV`：`production`
- `PORT`：`5000`

#### ビルド設定
- **Build Command**：
  ```
  cd client && npm install && npm run build && cd ../server && npm install && npm run build && npx prisma generate && npx prisma migrate deploy
  ```
- **Start Command**：
  ```
  cd server && npm start
  ```

### デプロイ後の確認事項
1. データベースが正しく接続されているか
2. 管理者アカウントでログインできるか
3. 研修コースが作成できるか
4. PDFファイルがアップロードできるか
5. PDFのページ数が自動的に取得されているか
6. 進捗バーが正しく表示されるか

---

## デザインのイメージ

### 色使い
- メインカラー：紫色（`#9333EA`）とブルー（`#3B82F6`）のグラデーション
- ボタン：青系（`#2563EB`）、緑系（`#10B981`）、赤系（`#EF4444`）
- 背景：白とグレーのグラデーション

### フォント
- 日本語フォント：システムフォント
- 見出し：太字、大きめ
- 本文：読みやすいサイズ

### レイアウト
- シンプルで分かりやすいデザイン
- スマホでも見やすい（レスポンシブ対応）
- アイコンを使って視覚的に分かりやすく
  - 📚：研修コース
  - 📄：PDF資料
  - 📝：Google Docs
  - 📊：Google Sheets
  - ✓：完了マーク

---

## 注意事項

### 必ず実装してほしいこと
1. **PDFのページ数自動取得**
   - `pdf-parse`ライブラリを使用（バージョン1.1.1）
   - アップロード時に自動的にページ数を取得して保存
   - ページ数が0にならないように必ず確認

2. **進捗の正確な計算**
   - PDFファイルのページ数の合計を計算
   - 外部リンクは進捗計算に含めない
   - パーセンテージと「X / Y ページ」の両方を表示

3. **セキュリティ**
   - パスワードは必ず`bcrypt`で暗号化
   - 非ログインユーザーは全てログイン画面にリダイレクト
   - 管理者でないユーザーは管理画面にアクセスできない

4. **エラーハンドリング**
   - ファイルアップロード失敗時のエラー表示
   - ログイン失敗時のエラー表示
   - データ取得失敗時のエラー表示

### やってはいけないこと
1. パスワードを平文（暗号化せずに）保存
2. 非公開の研修を一般ユーザーに表示
3. エラーが起きてもユーザーに何も表示しない
4. ページ数が0のままPDFを保存

---

## 完成後の確認リスト

### 管理者機能
- [ ] 管理者アカウントでログインできる
- [ ] 研修コースを作成できる
- [ ] 研修を公開/非公開に切り替えられる
- [ ] PDFファイルをアップロードできる
- [ ] PDFのページ数が自動的に表示される
- [ ] 外部リンクを追加できる
- [ ] 資料を削除できる
- [ ] ユーザーアカウントを作成できる
- [ ] ユーザーのパスワードを変更できる
- [ ] ユーザーを削除できる

### 一般ユーザー機能
- [ ] 一般ユーザーアカウントでログインできる
- [ ] 公開されている研修のみ表示される
- [ ] 各研修の進捗が正しく表示される
- [ ] PDFを画面上で見られる
- [ ] PDFのページを進めると進捗が記録される
- [ ] 「完了」ボタンで完了状態にできる
- [ ] 外部リンクを新しいタブで開ける
- [ ] 外部リンクをダウンロードできる
- [ ] 進捗バーが正しく動作する

### 全般
- [ ] Renderで正常に動作する
- [ ] データベースに正しくデータが保存される
- [ ] ログアウトできる
- [ ] エラーメッセージが適切に表示される
- [ ] スマホでも見やすい

---

## トラブルシューティング用のメモ

もし何か問題が起きたら、以下を確認してください：

### PDFのページ数が0になる場合
- `pdf-parse`がバージョン1.1.1でインストールされているか確認
- `file.buffer`を使ってPDFを読み込んでいるか確認
- Renderでビルドキャッシュをクリアして再デプロイ

### 進捗バーが表示されない場合
- PDFのページ数が正しく取得されているか確認
- 進捗計算で外部リンクを除外しているか確認
- データベースに進捗データが保存されているか確認

### ログインできない場合
- パスワードがbcryptで暗号化されているか確認
- JWT_SECRETが設定されているか確認
- データベースにユーザーが登録されているか確認

---

以上のプロンプトをAIデベロッパーに渡せば、eラーニング管理システムが作成されます。
